---
layout: post
title: "非对称秘钥加密"
date: 2018-02-22 
description: "非对称秘钥加密"
tag: 编码及加解密
---


<h6>
  <img src="https://robotkang-1257995526.cos.ap-chengdu.myqcloud.com/icon/copyright.png" alt="copyright" style="display:inline;margin-bottom: -5px;" width="20" height="20"> 版权声明：本文为博主原创文章，未经博主允许不得转载。

  <a target="_blank" href="https://jianghuhike.github.io/18222.html">
  原文地址：https://jianghuhike.github.io/18222.html 
  </a>
</h6>



## 目录
* [简介](#content0)
* [原理](#content1)
* [安全性](#content2)
* [代码实现](#content3)



## <a id="content0"></a> 简介
**目前主流的加密算法分为两种：对称秘钥加密和非对称秘钥加密。**

对称秘钥加密主要包括：DES 3DES AES

非对称秘钥加密又叫公开秘钥加密主要包括：RSA

对称秘钥加密：需要发送方与接收方知 道共享的秘密密钥,最初如何商定密钥( 尤其“素未谋面”)?

该篇主要讲解非对称秘钥加密，对称秘钥加密见上篇   
- [对称秘钥加密：https://jianghuhike.github.io/18218.html](https://jianghuhike.github.io/18218.html)   

**公开秘钥加密：完全不同的方法 [Diffie-Hellman76, RSA78]，解决了秘钥传输问题**
- 发送方与接收方无需共享秘密密钥
- 公开密钥(公钥)完全公开
- 私有密钥(私钥)只有接收方知道
 


## <a id="content1"></a> 原理

**需求:**
1. 公钥加密 KB+ 和私钥解密KB- 需要满足:KB- ( KB+(m) ) = m
2. 给定公钥 KB+ 不可能计算得到私钥 KB-

**前提条件: 模运算**    
x mod n = x除以n的余数     
事实上:    
[(a mod n) + (b mod n)] mod n = (a+b) mod n    
[(a mod n) - (b mod n)] mod n = (a-b) mod n    
[(a mod n) * (b mod n)] mod n = (a*b) mod n  

因此:    
(a mod n)d次方 mod n = a的d次方 mod n    
例如:x=14, n=10, d=2，则   
(x mod n)d次方 mod n = （4\*4） mod 10 = 6      
x的d次方 = 14\*14 = 196     
x的d次方 mod 10 = 6   

**预备知识**    
报文/信息(message): 仅仅是一个比特模式,每个比特模式可以表示为一个唯一的整数,因此，加密一个报文就等价于加密一个数例如:            
m= 10010001，可以唯一地表示为十进制 数145     
为了加密m，我们可以加密对应的数(145) ，得到一个新的数(即密文)   


**生成公钥/私钥对**    
1. 选择2个大质数p和q。(e.g., 1024bits的大质数)
2. 计算n = pq，z = (p-1)(q-1)  
3. 选择e满足e <n 使e与z 之间没有公因子，即e，z互质(relatively prime)
4. 选择d使得 e的d次方-1 刚好可以被z整除， (即:e的d次方modz =1).
5. 公钥: (n,e);私钥:(n,d). 

**加密、解密**
0. 给定公钥 (n,e)和私钥(n,d)
1. 加密报文m (m<n)时，计算 c = m的e次方 mod n
2. 解密密文c时，计算 m = c的d次方 mod n  
 
m=(m的e次方mod n)d次方 mod n 

**举例**
<img src="/images/encrypted/rsa1.png" alt="img">

**理论依据**
<img src="/images/encrypted/rsa2.png" alt="img">

**另一个重要性质**
<img src="/images/encrypted/rsa3.png" alt="img">




## <a id="content2"></a> 安全性

RSA的安全性建立在“大数分解和素性检测”这个数论难题的基础上
既将两个大素数相乘在计算上容易实现，而将该乘积分解的计算量相当大    
假设已知Bob的公钥(n,e)，那么有多大难 度确定d，即私钥(n,d)?    
本质上需要在不知道两个因子p和q的前提 下，找出n的因子分解一个大数是很困难的!  

RSA的幂运算强度很大 DES至少比RSA快100倍。实际应用中:利用公钥加密建立安全连接，然后建立第二个密钥-对称会话密钥，用于加密数据 

会话密钥(session key, KS)       
Bob与Alice利用RSA交换对称会话密钥KS     
一旦双方确认KS，则利用会话密钥加密/解密会话数据     


## <a id="content3"></a> 代码实现





----------
>  行者常至，为者常成！


