---
layout: post
title: "对称加密算法"
date: 2018-02-18 
description: "对称加密算法"
tag: 编码及加解密
---


<h6>
  <img src="https://robotkang-1257995526.cos.ap-chengdu.myqcloud.com/icon/copyright.png" alt="copyright" style="display:inline;margin-bottom: -5px;" width="20" height="20"> 版权声明：本文为博主原创文章，未经博主允许不得转载。

  <a target="_blank" href="https://jianghuhike.github.io/18218.html">
  原文地址：https://jianghuhike.github.io/18218.html 
  </a>
</h6>


- [参考文章：https://blog.csdn.net/lifeng_2009/article/details/5338687?spm=a2c6h.13066369.0.0.506b2945OZpllp](https://blog.csdn.net/lifeng_2009/article/details/5338687?spm=a2c6h.13066369.0.0.506b2945OZpllp)

## 目录
* [简介](#content0)
* [DES](#content1)
* [3DES](#content2)
* [AES](#content3)
* [代码实现](#content4)



## <a id="content0"></a> 简介
目前主流的加密算法分为两种：对称秘钥加密和非对称秘钥加密。   
1. 对称秘钥加密主要包括：DES、 3DES、 AES   
2. 非对称秘钥加密又称公开秘钥加密主要包括：RSA   

该篇主要讲解对称秘钥加密，非对称秘钥加密在下篇讲解   
- [非对称秘钥加密：https://jianghuhike.github.io/18222.html](https://jianghuhike.github.io/18222.html)

对称秘钥加密的特点是：   
**加密/解密使用相同的秘钥。**   
**是可逆的。**  


## <a id="content1"></a> DES
IBM公司研制1972年，美国国家标准局NBS (National Bureau of Standards)开始实施计算机数据保护标准的开发计划。1973年5月13日，NBS征集在传输和存贮数据中保护计算机数据的密码算法。  
1975年3月17日，首次公布DES算法描述。  
1977年1月15日，正式批准为加密标准(FIPS-46)，当年7 月1日正式生效。  
1994年1月的评估后决定1998年12月以后不再将DES作为数据加密标准。 

### DES算法结构如下图：   

<img src="/images/encrypted/des5.png" alt="img">

DES是16轮的Feistel结构密码   
DES是一个包含16个阶段的“替代--置换”的分组加密算法。  
DES的分组长度是64位的分组明文序列作为加密算法的输入，经过16轮加密得到64位的密文序列    
DES使用56位的密钥，每一轮使用48位的子密钥，每个子密钥是56位密钥的子集构成   

**一、IP置换**   
把输入的64位数据的排列顺序打乱，每位数据按照下面规则重新组合    
<img src="/images/encrypted/des6.png" alt="img">

**二、一轮DES加密过程**

<img src="/images/encrypted/des7.png" alt="img">  

该过程主要包括两部分：   
子秘钥的生成  

<img src="/images/encrypted/des8.png" alt="img"> 

f函数的操作部分：扩展变换、与子秘钥的异或运算、S盒替换、P盒置换  
1. 扩展变换:扩展变换(Expansion Permutation，也被称 为E-盒)将64位输入序列的右半部分从32位扩展到48位。确保最终的密文与所有的明文位都有关。
<img src="/images/encrypted/des9.png" alt="img"> 

2. S-盒替代(S-boxes Substitution)
<img src="/images/encrypted/des10.png" alt="img"> 

3. P-盒置换(P-boxes Permutation)
<img src="/images/encrypted/des11.png" alt="img">    

**三、逆初始置换**    
初始置换和对应的逆初始置换操作并不会增强DES算法的安全性。主要目的是为了更容易地将明文和密文数据以字节大小放入DES芯片中   
<img src="/images/encrypted/des12.png" alt="img">


### DES算法的安全性
DES的安全性：
- DES的56位密钥可能太小，1998年7月，EFE(电子前哨基金会)宣布攻破了DES算法，他们使用的是不到25万美元的特殊的“DES破译机”，这种攻击只需要不到3天的时间。
- DES的迭代次数可能太少，16次恰巧能抵抗差分分析。
- S盒(即替代函数S)中可能有不安全因素。
- DES的一些关键部分不应当保密。
- DES存在弱密钥和半弱密钥  

针对DES的攻击方法:
- 差分分析方法(Difference Analysis Method) 
- 线性分析方法(Linear Analysis Method)
- 旁路攻击法(Side-Channel Attack)

### 关于DES算法56位秘钥   
我们在实际使用中秘钥的长度往往是64位，为什么这里说是56位呢，因为64位秘钥中的 8 16 24 32 40 48 56 64这8位是校验位，不参与实际的加密运算，所以实际使用的是56位秘钥。那么这里就要注意一个问题，当我们使用 8个0x30 做为秘钥时与使用8个0x31做为秘钥时，虽然秘钥不同，但加密结果一致。因为这两个秘钥除了校验位不同外其余56位相同。 

echo -n 520it123 | openssl enc -des-ecb -K 3030303030303030 -nosalt | base64       
IaWvZKpZ0GWtaoi0+jeDPQ==

echo -n 520it123 | openssl enc -des-ecb -K 3131313131313131 -nosalt | base64    
IaWvZKpZ0GWtaoi0+jeDPQ==

### DES算法的ECB模式和CBC模式

- ECB模式   

<img src="/images/encrypted/des13.png" alt="img">

echo -n 520it123abcdefgh | openssl enc -des-ecb -K 3131313131313131 -nosalt | base64   
IaWvZKpZ0GV4c+2odsoP6q1qiLT6N4M9   

echo -n 520it123bbcdefgh | openssl enc -des-ecb -K 3131313131313131 -nosalt | base64   
IaWvZKpZ0GVMlsPGsiDhma1qiLT6N4M9   

对比一下只有中间部分不一致：   
IaWvZKpZ0GV  4c+2odsoP6q  1qiLT6N4M9      
IaWvZKpZ0GV  MlsPGsiDhma  1qiLT6N4M9    


- CBC模式   

<img src="/images/encrypted/des14.png" alt="img">

echo -n 520it123abcdefgh | openssl enc -des-cbc -iv 0102030405060708 -K 3131313131313131 -nosalt | base64    
nfGGM1uAJDJtt9A+kfKbEVjgJiJztSL/    

echo -n 520it123bbcdefgh | openssl enc -des-cbc -iv 0102030405060708 -K 3131313131313131 -nosalt | base64    
nfGGM1uAJDKSvPgJXXCRNgjet4iD1wlQ    

对比一下 从某一位置起后边都不一致：  
nfGGM1uAJD   Jtt9A+kfKbEVjgJiJztSL/     
nfGGM1uAJD   KSvPgJXXCRNgjet4iD1wlQ       









## <a id="content2"></a> 3DES



## <a id="content3"></a> AES



## <a id="content4"></a> 代码实现





----------
>  行者常至，为者常成！


