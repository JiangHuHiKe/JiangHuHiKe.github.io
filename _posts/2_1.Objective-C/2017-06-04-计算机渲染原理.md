---
layout: post
title: "计算机渲染原理"
date: 2017-06-04
tag: Objective-C
---


- [参考文章：计算机渲染原理与CoreAnimation](https://www.jianshu.com/p/ee74466f7d63)
- [参考文章：CoreAnimation渲染流水线](https://www.jianshu.com/p/a9cb00ed4372)



## 目录
* [渲染原理](#content1)



<!-- ************************************************ -->
## <a id="content1">渲染原理</a>

#### **一、屏幕刷新率是60FPS，且UI在主线程刷新**

1秒是1000毫秒，每秒进行60次屏幕刷新，也就是60帧图像，所以每帧图像停留的时间是16.17毫秒    

**UI为什么要在主线程刷新？**  

1、UIKit框架不是线程安全的，在不同的线程下分别更新UI会有问题，比如一个线程要把lable显示成功两个字，一个线程要把lable显示失败两个字。    
所以需要放在一个线程内，这个线程就是主线程        

2、用户的触摸、手势等事件都是在主线程上处理的，如果 UI 操作在其他线程上执行，可能导致用户界面的不同部分出现不同的响应速度，影响用户体验。       
xy:比如我对一个view进行了两次操作，一次缩放,一次移动，如果这两次UI更新放在两个线程执行有可能出现先移动后缩放的效果      


#### **二、屏幕的刷新是三者配合的共同结果**   

**1、CPU(计算)**    
视图的创建、布局计算、图片解码、文本绘制等

**2、GPU(渲染)**     
则在物理层上完成了对图像的渲染(顶点着色器、片元着色器等)    
数据提交到帧缓冲区  

**3、垂直同步信号**    
Frame Buffer、视频控制器等相关部件，将图像显示在屏幕上


在runloop即将休眠时进行UI刷新
update cycle
kCFRunLoopBeforeWaiting = (1UL << 5), // 即将进入休眠时进行UI刷新
此处的UI刷新指的是CPU将计算好的数据提交给GPU,真正的屏幕刷新还是垂直同步信号





----------
>  行者常至，为者常成！


