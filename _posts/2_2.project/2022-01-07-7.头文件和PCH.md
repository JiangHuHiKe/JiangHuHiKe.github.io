---
layout: post
title: "7.头文件和PCH"
date: 2022-01-07
tag: 工程化
---


## 目录
- [PCH文件](#content1)   
- [编译流程](#content2)   



<!-- ************************************************ -->
## <a id="content1">PCH文件</a>

#### **一、include 和 import**

include  不会去重，   
include "viewcontroller.h"   
include "viewcontroller.h"    

import对同一个路径下的头文件不会重复引入     
如果有两个相同的头文件，位于不同的目录下，那么也不会去重      
import = include + #pragma once

<span style="color:red;font-weight:bold">下面这种说法未理解</span>
```
import 维护了一个字典    
import "viewcontroller.h"    
如果在字典里能找到路径的话就不会再引入     
import "viewcontroller.h"     
```

#### **二、头文件是如何找到的**    
编译器：header_search_path       
完整路径 = header_search_path + viewcontroller.h        


#### **三、pch** 

PCH文件叫预编译头文件，是为缩短编译时间而存在的  

只编译一次：PCH文件在预编译阶段和编译的前期阶段，会替换其中的宏定义，生成ast产物     

全局可见：ast产物会被拷贝到项目中的所有的.m文件内

所以pch文件节省的是重复编译的时间，但重复拷贝的时间并没有被节省甚至还增加了，因为有的.m文件不需要引入pch也给引入了

pch在config文件中的配置
```shell
GCC_PRECOMPILE_PREFIX_HEADER = YES
GCC_PREFIX_HEADER = LGApp/LGApp-prefix.pch
```

#### **四、讲课中用到的一些指令**

```shell
clang -x objective-c-header -c include/Zoo.pch -o include/Zoo.pch.gch

# llvm-bcanalyzer 来分析二进制位码（Bitcode）文件的内容    
# --dump 标志表示要输出详细的信息   
# 这个命令的目的是对 zoo.pch.gch 文件进行分析，并以人类可读的方式输出其内容 
llvm-bcanalyzer --dump Zoo.pch.gch
llvm-bcanalyzer --dump Zoo.pch.gch > zoo.xml
llvm-bcanalyzer --dump Zoo.pch.gch --show-binary-blobs > zoo.xml

clang -x objective-c -include-pch include/Zoo.pch.gch -emit-llvm use.m -S
```

<!-- ************************************************ -->
## <a id="content2">编译流程</a>

<img src="/images/project/26.png">
    
<img src="/images/project/27.png">

<img src="/images/project/28.png">



----------
>  行者常至，为者常成！


